<div class="campaign-report-container">
    <!-- Page Header -->
    <div class="page-header">
        <h4 class="page-title">Campaigns Report</h4>
    </div>

    <!-- Control Bar -->
    <div class="control-bar">
        <div class="control-left">
            <!-- Switch Report -->
            <div class="control-group">
                <label class="control-label">Switch Report</label>
                <select class="form-select form-select-sm" [(ngModel)]="switchReport">
                    <option *ngFor="let type of reportTypes" [value]="type.value">{{type.label}}</option>
                </select>
            </div>

            <!-- Saved Reports -->
            <div class="control-group">
                <label class="control-label">Saved Reports</label>
                <select class="form-select form-select-sm" [(ngModel)]="savedReports">
                    <option *ngFor="let report of savedReportsList" [value]="report.value">{{report.label}}</option>
                </select>
            </div>

            <!-- Help Link -->
            <a href="#" class="help-link">To know more, click here.</a>
        </div>

        <div class="control-right">
            <!-- View Toggle -->
            <div class="view-toggle">
                <button class="btn btn-sm" [class.active]="viewMode === 'table'" (click)="setViewMode('table')"
                    title="Table View">
                    <i class="fas fa-table"></i>
                </button>
                <button class="btn btn-sm" [class.active]="viewMode === 'chart'" (click)="setViewMode('chart')"
                    title="Chart View">
                    <i class="fas fa-chart-bar"></i>
                </button>
            </div>

            <!-- Date Range -->
            <div class="date-range">
                <i class="fas fa-calendar-alt me-2"></i>
                <input type="date" class="form-control form-control-sm" [(ngModel)]="startDate">
                <span class="date-separator">-</span>
                <input type="date" class="form-control form-control-sm" [(ngModel)]="endDate">
            </div>
        </div>
    </div>

    <!-- Action Toolbar -->
    <div class="action-toolbar">
        <div class="toolbar-left">
            <!-- Download Button -->
            <div class="dropdown download-dropdown">
                <button class="btn btn-dark btn-sm" (click)="toggleDownloadMenu()">
                    <i class="fas fa-download me-1"></i> Download
                    <i class="fas fa-chevron-down ms-1"></i>
                </button>
                <ul class="dropdown-menu" [style.display]="showDownloadMenu ? 'block' : 'none'">
                    <li><a class="dropdown-item" href="javascript:void(0)" (click)="downloadCSV()">
                            <i class="fas fa-file-csv me-2"></i> CSV
                        </a></li>
                    <li><a class="dropdown-item" href="javascript:void(0)" (click)="downloadExcel()">
                            <i class="fas fa-file-excel me-2"></i> Excel
                        </a></li>
                    <li><a class="dropdown-item" href="javascript:void(0)" (click)="downloadPDF()">
                            <i class="fas fa-file-pdf me-2"></i> PDF
                        </a></li>
                </ul>
            </div>

            <!-- New Report Button -->
            <button class="btn btn-primary btn-sm" (click)="createNewReport()">
                <i class="fas fa-plus me-1"></i> New Report
            </button>
        </div>

        <div class="toolbar-right">
            <!-- Search -->
            <div class="search-box">
                <label>Search:</label>
                <input type="text" class="form-control form-control-sm" [(ngModel)]="searchQuery" placeholder="">
            </div>
        </div>
    </div>

    <!-- Content Card -->
    <div class="content-card">
        <!-- Table View -->
        <div class="table-responsive" *ngIf="viewMode === 'table'">
            <table class="table table-striped table-hover align-middle mb-0">
                <thead>
                    <tr>
                        <th class="sortable">
                            Campaign <i class="fas fa-sort ms-1"></i>
                        </th>
                        <th class="text-end sortable">
                            Gross Clicks <i class="fas fa-sort ms-1"></i>
                        </th>
                        <th class="text-end sortable">
                            Approved Conversions <i class="fas fa-sort ms-1"></i>
                        </th>
                        <th class="text-end sortable">
                            Payout <i class="fas fa-sort ms-1"></i>
                        </th>
                        <th class="text-end sortable">
                            Revenue <i class="fas fa-sort ms-1"></i>
                        </th>
                        <th class="text-end sortable">
                            Profit <i class="fas fa-sort ms-1"></i>
                        </th>
                    </tr>
                </thead>
                <tbody>
                    <tr *ngFor="let item of filteredData">
                        <td>
                            <a href="#" class="campaign-link">{{item.campaign}}</a>
                        </td>
                        <td class="text-end">{{formatNumber(item.grossClicks)}}</td>
                        <td class="text-end">
                            <a href="#" class="conversion-link">{{item.approvedConversions}}</a>
                        </td>
                        <td class="text-end">{{formatCurrency(item.payout)}}</td>
                        <td class="text-end">{{formatCurrency(item.revenue)}}</td>
                        <td class="text-end">{{formatCurrency(item.profit)}}</td>
                    </tr>
                </tbody>
                <tfoot>
                    <tr class="totals-row">
                        <td><strong>Total</strong></td>
                        <td class="text-end"><strong>{{formatNumber(totals.grossClicks)}}</strong></td>
                        <td class="text-end"><strong>{{totals.approvedConversions}}</strong></td>
                        <td class="text-end"><strong>{{formatCurrency(totals.payout)}}</strong></td>
                        <td class="text-end"><strong>{{formatCurrency(totals.revenue)}}</strong></td>
                        <td class="text-end"><strong>{{formatCurrency(totals.profit)}}</strong></td>
                    </tr>
                </tfoot>
            </table>
        </div>

        <!-- Pagination Info -->
        <div class="pagination-info" *ngIf="viewMode === 'table'">
            Showing 1 to {{filteredData.length}} of {{filteredData.length}} entries
        </div>

        <!-- Chart View -->
        <div class="chart-container" *ngIf="viewMode === 'chart'">
            <div class="chart-placeholder">
                <i class="fas fa-chart-bar fa-4x text-muted mb-3"></i>
                <p class="text-muted">Chart visualization will be displayed here</p>
            </div>
        </div>
    </div>

    <!-- Floating Filter Button -->
    <button class="filter-fab" (click)="toggleFilterPanel()" title="Search Filter">
        <i class="fas fa-filter"></i>
    </button>

    <!-- Filter Panel Overlay -->
    <div class="filter-overlay" *ngIf="showFilterPanel" (click)="closeFilterPanel()"></div>

    <!-- Filter Panel -->
    <div class="filter-panel" [class.open]="showFilterPanel">
        <div class="filter-header">
            <h5><i class="fas fa-filter me-2"></i> Search Filter</h5>
            <button type="button" class="btn-close" (click)="closeFilterPanel()"></button>
        </div>

        <div class="filter-body">
            <!-- Main Filters Section -->
            <div class="filter-section">
                <!-- Campaign -->
                <div class="row mb-3">
                    <div class="col-6">
                        <label class="form-label">Campaign</label>
                        <input type="text" class="form-control form-control-sm" [(ngModel)]="filters.campaign"
                            placeholder="Search campaign...">
                        <div class="form-check mt-1">
                            <input class="form-check-input" type="checkbox" [(ngModel)]="filters.campaignSearchById"
                                id="campaignById">
                            <label class="form-check-label small" for="campaignById">Search By IDs</label>
                        </div>
                    </div>
                    <div class="col-6">
                        <label class="form-label">Publisher</label>
                        <input type="text" class="form-control form-control-sm" [(ngModel)]="filters.publisher"
                            placeholder="Search publisher...">
                        <div class="form-check mt-1">
                            <input class="form-check-input" type="checkbox" [(ngModel)]="filters.publisherSearchById"
                                id="publisherById">
                            <label class="form-check-label small" for="publisherById">Search By IDs</label>
                        </div>
                    </div>
                </div>

                <div class="row mb-3">
                    <div class="col-6">
                        <label class="form-label">Advertiser</label>
                        <input type="text" class="form-control form-control-sm" [(ngModel)]="filters.advertiser"
                            placeholder="Search advertiser...">
                        <div class="form-check mt-1">
                            <input class="form-check-input" type="checkbox" [(ngModel)]="filters.advertiserSearchById"
                                id="advertiserById">
                            <label class="form-check-label small" for="advertiserById">Search By IDs</label>
                        </div>
                    </div>
                </div>

                <!-- Quick Toggle Filters -->
                <div class="quick-filters">
                    <div class="form-check form-check-inline">
                        <input class="form-check-input" type="checkbox" [(ngModel)]="filters.campaignGeo"
                            id="filterCampaignGeo">
                        <label class="form-check-label" for="filterCampaignGeo">Campaign GEO</label>
                    </div>
                    <div class="form-check form-check-inline">
                        <input class="form-check-input" type="checkbox" [(ngModel)]="filters.teamMember"
                            id="filterTeamMember">
                        <label class="form-check-label" for="filterTeamMember">Team Member</label>
                    </div>
                    <div class="form-check form-check-inline">
                        <input class="form-check-input" type="checkbox" [(ngModel)]="filters.advertiserTags"
                            id="filterAdvertiserTags">
                        <label class="form-check-label" for="filterAdvertiserTags">Advertiser Tags</label>
                    </div>
                    <div class="form-check form-check-inline">
                        <input class="form-check-input" type="checkbox" [(ngModel)]="filters.publisherTags"
                            id="filterPublisherTags">
                        <label class="form-check-label" for="filterPublisherTags">Publisher Tags</label>
                    </div>
                    <div class="form-check form-check-inline">
                        <input class="form-check-input" type="checkbox" [(ngModel)]="filters.campaignAppId"
                            id="filterCampaignAppId">
                        <label class="form-check-label" for="filterCampaignAppId">Campaign App ID</label>
                    </div>
                    <div class="form-check form-check-inline">
                        <input class="form-check-input" type="checkbox" [(ngModel)]="filters.category"
                            id="filterCategory">
                        <label class="form-check-label" for="filterCategory">Category</label>
                    </div>
                    <div class="form-check form-check-inline">
                        <input class="form-check-input" type="checkbox" [(ngModel)]="filters.smartLink"
                            id="filterSmartLink">
                        <label class="form-check-label" for="filterSmartLink">Smart Link</label>
                    </div>
                </div>
            </div>

            <!-- Group By Section -->
            <div class="filter-section">
                <div class="section-header">
                    <h6 class="section-title">Group By <i class="fas fa-cog"></i></h6>
                    <div class="section-actions">
                        <input type="text" class="form-control form-control-sm search-input" [(ngModel)]="groupBySearch"
                            placeholder="Search">
                        <button class="btn btn-link btn-sm" (click)="clearGroupBy()">Clear</button>
                        <button class="btn btn-link btn-sm" (click)="selectAllGroupBy()">Select All</button>
                    </div>
                </div>
                <div class="checkbox-grid grid-5">
                    <div class="form-check" *ngFor="let option of filteredGroupByOptions">
                        <input class="form-check-input" type="checkbox" [(ngModel)]="option.checked"
                            [id]="'group_' + option.key">
                        <label class="form-check-label" [for]="'group_' + option.key">{{option.label}}</label>
                    </div>
                </div>
            </div>

            <!-- Report Options / Metrics Section -->
            <div class="filter-section">
                <div class="section-header">
                    <h6 class="section-title">Report Options <i class="fas fa-cog"></i></h6>
                    <div class="section-actions">
                        <input type="text" class="form-control form-control-sm search-input" [(ngModel)]="metricsSearch"
                            placeholder="Search">
                        <button class="btn btn-link btn-sm" (click)="clearMetrics()">Clear</button>
                        <button class="btn btn-link btn-sm" (click)="selectAllMetrics()">Select All</button>
                    </div>
                </div>
                <div class="checkbox-grid grid-5">
                    <div class="form-check" *ngFor="let metric of filteredMetricsOptions">
                        <input class="form-check-input" type="checkbox" [(ngModel)]="metric.checked"
                            [id]="'metric_' + metric.key">
                        <label class="form-check-label" [for]="'metric_' + metric.key">{{metric.label}}</label>
                    </div>
                </div>
            </div>

            <!-- Other Options Section -->
            <div class="filter-section">
                <h6 class="section-title">Other options:</h6>
                <div class="other-options-grid">
                    <div class="form-check">
                        <input class="form-check-input" type="checkbox"
                            [(ngModel)]="otherOptions.onlyShowRowsHavingConversions" id="optConversions">
                        <label class="form-check-label" for="optConversions">Only show rows having conversions</label>
                    </div>
                    <div class="form-check">
                        <input class="form-check-input" type="checkbox"
                            [(ngModel)]="otherOptions.onlyShowRowsHavingRevenue" id="optRevenue">
                        <label class="form-check-label" for="optRevenue">Only show rows having revenue</label>
                    </div>
                    <div class="form-check">
                        <input class="form-check-input" type="checkbox" [(ngModel)]="otherOptions.showManagerId"
                            id="optManagerId">
                        <label class="form-check-label" for="optManagerId">Show Manager ID</label>
                    </div>
                    <div class="form-check">
                        <input class="form-check-input" type="checkbox" [(ngModel)]="otherOptions.showInProfileCurrency"
                            id="optProfileCurrency">
                        <label class="form-check-label" for="optProfileCurrency">Show in profile currency</label>
                    </div>
                    <div class="form-check">
                        <input class="form-check-input" type="checkbox" [(ngModel)]="otherOptions.hideDecimalValues"
                            id="optHideDecimals">
                        <label class="form-check-label" for="optHideDecimals">Hide Decimal Values</label>
                    </div>
                </div>
            </div>

            <!-- Conditions Section -->
            <div class="filter-section">
                <h6 class="section-title">Conditions</h6>
                <div class="conditions-list">
                    <div class="condition-row" *ngFor="let condition of conditions; let i = index">
                        <select class="form-select form-select-sm" [(ngModel)]="condition.field">
                            <option value="">Select Field</option>
                            <option value="grossClicks">Gross Clicks</option>
                            <option value="conversions">Conversions</option>
                            <option value="payout">Payout</option>
                            <option value="revenue">Revenue</option>
                            <option value="profit">Profit</option>
                        </select>
                        <select class="form-select form-select-sm" [(ngModel)]="condition.operator">
                            <option value="equals">Equals</option>
                            <option value="greaterThan">Greater Than</option>
                            <option value="lessThan">Less Than</option>
                            <option value="notEquals">Not Equals</option>
                        </select>
                        <input type="text" class="form-control form-control-sm" [(ngModel)]="condition.value"
                            placeholder="Value">
                        <button class="btn btn-sm btn-outline-danger" (click)="removeCondition(i)">
                            <i class="fas fa-times"></i>
                        </button>
                    </div>
                </div>
                <button class="btn btn-outline-primary btn-sm mt-2" (click)="addCondition()">
                    <i class="fas fa-plus me-1"></i> Add Condition
                </button>
            </div>
        </div>

        <div class="filter-footer">
            <button class="btn btn-primary" (click)="applyFilters()">
                <i class="fas fa-check me-1"></i> Submit
            </button>
            <button class="btn btn-outline-secondary" (click)="closeFilterPanel()">Close</button>
        </div>
    </div>

    <!-- New Report Modal -->
    <div class="modal-overlay" *ngIf="showNewReportModal" (click)="closeNewReportModal()"></div>
    <div class="new-report-modal" *ngIf="showNewReportModal">
        <div class="modal-header">
            <h5 class="modal-title">Create New Report</h5>
        </div>
        <div class="modal-body">
            <input type="text" class="form-control" [(ngModel)]="newReportName" placeholder="Enter Report Name"
                (keyup.enter)="confirmNewReport()">
        </div>
        <div class="modal-footer">
            <button class="btn btn-primary btn-sm" (click)="confirmNewReport()">Yes</button>
            <button class="btn btn-outline-secondary btn-sm" (click)="closeNewReportModal()">Cancel</button>
        </div>
    </div>
</div>